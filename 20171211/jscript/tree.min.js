(function($){var m="images/";var n=m+"base.gif";var o=m+"join.gif";var p=m+"joinbottom.gif";var q=m+"minus.gif";var r=m+"minusbottom.gif";var s=m+"plus.gif";var t=m+"plusbottom.gif";var u=m+"empty.gif";var w=m+"line.gif";var x=m+"folderopen.gif";var y=m+"page.gif";var z=m+"folder.gif";var A=new Array();A[true]=q;A[false]=s;var B=new Array();B[true]=r;B[false]=t;var C=new Array();C[true]=x;C[false]=z;var D=function(a){n=a+"base.gif";o=a+"join.gif";p=a+"joinbottom.gif";q=a+"minus.gif";r=a+"minusbottom.gif";s=a+"plus.gif";t=a+"plusbottom.gif";u=a+"empty.gif";w=a+"line.gif";x=a+"folderopen.gif";y=a+"page.gif";z=a+"folder.gif";A=new Array();A[true]=q;A[false]=s;B=new Array();B[true]=r;B[false]=t;C=new Array();C[true]=x;C[false]=z};var E=function(d,e){D(e.picpath);var f=$("<ul></ul>");f.level=0;var g=$("<img align='absmiddle' />");g.attr('src',n);var h=F('根节点',null,e);var i=d;f.append(g).append(h);i.append(f);var j=$("<div></div>");j.parent=f;i.append(j);var k=e.isexpend;var l={};$.ajax({type:"POST",contentType:'application/json',url:e.url,data:JSON.stringify(l),dataType:'json',success:function(a){if(a){G(a,f.level,j,k,e)}},error:function(a,b,c){alert(a.status);alert(a.readyState);alert(b)}})};var F=function(a,b,c){var d=$("<span></span>");d.append(a).addClass("caption");if(b!=null){d.on('mouseover',function(){d.removeClass();d.addClass("captionActive")});d.on('mouseout',function(){d.removeClass();d.addClass("caption")});d.on('click',function(){(c.onclick)(b)});d.css('cursor','pointer')};return d};var G=function(e,f,g,h,i){var j=e.length;var l=1;$.each(e,function(k,v){var b=$("<ul></ul>");var c=null;if(v.items!=null&&v.items.length>=1){c=$("<div></div>");c.parent=b};b.level=f+1;b.isFirstChild=(l==1?true:false);b.isLastChild=(l==j?true:false);b.parent=g;l=l+1;g.append(b);H(v,b,h);I(v,b,h);var d=F(v.name,v,i);b.append(d);if(v.items!=null&&v.items.length>=1){b.append(c);G(v.items,b.level,c,h,i);b.expand=function(a){if(a==null){if(c.css('display')=="block"){c.css('display','none');return false}else{c.css('display','block');return true}}else{if(a){c.css('display','block')}else{c.css('display','none')}}};b.expand(h)}})};var H=function(b,c,d){var e=(b.items!=null&&b.items.length>=1);for(var i=1;i<c.level;i++){var f=c;for(var j=c.level;j>i;j--){f=f.parent.parent};var g=null;if(f.isLastChild){g=$("<img align='absmiddle' />");g.attr('src',u)}else{g=$("<img align='absmiddle' />");g.attr('src',w)};c.append(g)};var h;if(e){if(!c.isLastChild){h=$("<img align='absmiddle' />");h.attr('src',A[d])}else{h=$("<img align='absmiddle' />");h.attr('src',B[d])};c.append(h);h.on('click',function(){var a=c.expand();if(!c.isLastChild){if(a){c.children("img[src*='folder.gif']").attr('src',C[a]);c.children("img[src*='plus.gif']").attr('src',A[a])}else{c.children("img[src*='open.gif']").attr('src',C[a]);c.children("img[src*='minus.gif']").attr('src',A[a])}}else{if(a){c.children("img[src*='folder.gif']").attr('src',C[a]);c.children("img[src*='plusbottom.gif']").attr('src',B[a])}else{c.children("img[src*='open.gif']").attr('src',C[a]);c.children("img[src*='minusbottom.gif']").attr('src',B[a])}}});c.expandBtn=h}else{if(!c.isLastChild){h=$("<img align='absmiddle' />");h.attr('src',o)}else{h=$("<img align='absmiddle' />");h.attr('src',p)};c.append(h)}};var I=function(a,b,c){var d=(a.items!=null&&a.items.length>=1);var e=null;if(d){e=$("<img align='absmiddle' />");e.attr('src',C[d])}else{e=$("<img align='absmiddle' />");e.attr('src',y)};b.append(e)};var J={init:function(d){return this.each(function(){var a=$(this);var b=a.data('sgTree');if(typeof(b)=='undefined'){var c={isexpend:true,datatype:'json',url:'tree.json',onclick:function(){},picpath:'images/'};b=$.extend({},c,d);a.data('sgTree',b)}else{b=$.extend({},b,d)};E(a,b)})},reload:function(a){var b=$(this).data('sgTree');b=$.extend({},b,a);if(b.isFixed==false){}else{$(this).data('sgTree',b)};$(this).empty();E($(this),b)},destroy:function(b){return $(this).each(function(){var a=$(this);a.removeData('sgTree')})},val:function(a){var b=this.eq(0).html();return b}};$.fn.sgTree=function(){var a=arguments[0];if(J[a]){a=J[a];arguments=Array.prototype.slice.call(arguments,1)}else if(typeof(a)=='object'||!a){a=J.init}else{$.error('Method '+a+' does not exist on jQuery.sgTree');return this};return a.apply(this,arguments)}})(jQuery);